{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "HydroShootParameters",
  "description": "The schema for HydroShoot parameters",
  "type": "object",
  "properties": {
    "simulation": {
      "type": "object",
      "description": "Simulation configuration parameters",
      "properties": {
        "sdate": {
          "type": "string",
          "format": "date_time",
          "description": "starting date of the simulation"
        },
        "edate": {
          "type": "string",
          "format": "date_time",
          "description": "end date of the simulation"
        },
        "latitude": {
          "type": "number",
          "description": "[decimal degrees] latitude of location"
        },
        "longitude": {
          "type": "number",
          "description": "[decimal degrees] longitude of location"
        },
        "elevation": {
          "type": "number",
          "description": "[m.a.s.l] latitude of location"
        },
        "tzone": {
          "type": "string",
          "description": "Area/Location timezone according to the Olson timezone database"
        },
        "output_index": {
          "type": "string",
          "description": "Index to be added to the name of the simulation outputs folder"
        },
        "unit_scene_length": {
          "type": "string",
          "description": "Unit length of scene elements"
          "oneOf": ["mm", "cm", "m"]
        },
        "simplified_form_factors": {
          "type": "boolean",
          "description": "`true` to use the simplified form factors method"
        },
        "hydraulic_structure": {
          "type": "boolean",
          "description": "`true` to calculate shoot hydraulic structure: leaf water potential is calculated and used in stomatal conductance model; `false` to use leaf-to-air vapor pressure deficit"
        },
        "negligible_shoot_resistance": {
          "type": "boolean",
          "description": "`true` to omit shoot hydraulic resistance: leaf water potential is equal to soil water potential; `false` to calculate leaf water potential as part of the hydraulic structure"
        },
        "energy_budget": {
          "type": "boolean",
          "description": "`true` to calculate leaf temperature from leaf energy budget; `false` to set leaf temperature equal to air temperature"
        },
        "soil_water_deficit": {
          "type": "boolean",
          "description": "`true` to allow simulating soil water deficit; `false` to prevent soil water from dropping below a given threshold"
        }
      },
      "required": [
        "sdate",
        "edate",
        "latitude",
        "longitude",
        "elevation",
        "tzone",
        "output_index",
        "unit_scene_length",
        "simplified_form_factors",
        "hydraulic_structure",
        "negligible_shoot_resistance",
        "energy_budget",
        "soil_water_deficit"
      ]

    },
    "phenology": {
      "type": "object",
      "description": "Parameters required for calculating cumulative degree-day temperature since budbreak"
      "properties": {
        "emdate": {
          "type": "string",
          "format": "date_time",
          "description": "Observed date of budbreak"
        },
        "t_base": {
          "type": "number",
          "description": "[degrees] base temperature for cumulative degree-days calculations",
          "minimum": 0
        }
      },
      "required": [
        "emdate",
        "t_base"
      ]
    },
    "mtg_api": {
      "type": "object",
      "description": "API in order to allow HydroShoot to identify the different shoot hydraulic segments",
      "properties": {
        "collar_label": {
          "type": "string",
          "description": "Label prefix of the collar internode (required to identify the first segment of the hydraulic structure)"
        },
        "leaf_lbl_prefix": {
          "type": "string",
          "description": "Label prefix of the leaf"
        },
        "stem_lbl_prefix": {
          "type": "array",
          "description": "Label prefices of the internodes, petioles, and complex-nodes resulting from pruning over successive years",
          "minItems": 3,
          "maxItems": 3,
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "collar_label",
        "leaf_lbl_prefix",
        "stem_lbl_prefix"
      ]
    },
    "numerical_resolution": {
      "type": "object",
      "description": "Requirements for the numerical resolution of the hydraulic and energy-balance systems",
      "properties": {
        "max_iter": {
          "type": "integer",
          "description": "Maximum number of iterations (for both hydraulic and energy-balance calculations)"
          "exclusiveMinimum": 0,
          "maximum": 200
        },
        "psi_step": {
          "type": "number",
          "description": "Reduction factor to the xylem water potential step value between two consecutive iterations in the case of non convergence",
          "exclusiveMinimum": 0,
          "maximum": 1
        },
        "psi_error_threshold": {
          "type": "number",
          "description": "[MPa] Maximum allowable cumulative squared difference in xylem water potential between two consecutive iterations",
          "minimum": 0
        },
        "t_step": {
          "type": "number",
          "description": "Reduction factor to the leaf temperature step value between two consecutive iterations in the case of non convergence",
          "exclusiveMinimum": 0,
          "maximum": 1
        },
        "t_error_crit": {
          "type": "number",
          "description": "[degrees Celsius] Maximum allowable cumulative squared difference in leaf temperature between two consecutive iterations",
          "minimum": 0
        }
      },
      "required": [
        "max_iter",
        "psi_step",
        "psi_error_threshold",
        "t_step",
        "t_error_crit"
      ]
    },
    "irradiance": {
      "type": "object",
      "description": "Irradiance interception parameters to be used in the Caribu model (Chelle et al. 1998, Ecol. Model. 111, 75  91)",
      "properties": {
        "E_type": {
          "type": "string",
          "description": "Unit of the irradiance flux density used in the simulation",
          "oneOf": ["Rg_Watt/m2", "RgPAR_Watt/m2", "PPFD_umol/m2/s"]
        },
        "E_type2": {
          "type": "string",
          "description": "Unit of the desired simulated irradiance flux density output",
          "oneOf": ["Ei", "Eabs"]
        },
        "opt_prop": {
          "type": "object",
          "description": "Optical properties od scene elements",
          "properties":
        }
      }
    }
  },
  "required": [
    "simulation",
    "phenology",
    "mtg_api",
    "numerical_resolution"
  ]
}
